
//▒██   ██▒▒██   ██▒▒██   ██▒   ▄▄▄█████▓ ██░ ██ ▓█████    ▓█████▄  ▄▄▄       ██▀███   ██ ▄█▀ ██▓███   ██▀███   ▒█████    ▄████  ██▀███   ▄▄▄       ███▄ ▄███▓▓█████  ██▀███     ▒██   ██▒▒██   ██▒▒██   ██▒
//▒▒ █ █ ▒░▒▒ █ █ ▒░▒▒ █ █ ▒░   ▓  ██▒ ▓▒▓██░ ██▒▓█   ▀    ▒██▀ ██▌▒████▄    ▓██ ▒ ██▒ ██▄█▒ ▓██░  ██▒▓██ ▒ ██▒▒██▒  ██▒ ██▒ ▀█▒▓██ ▒ ██▒▒████▄    ▓██▒▀█▀ ██▒▓█   ▀ ▓██ ▒ ██▒   ▒▒ █ █ ▒░▒▒ █ █ ▒░▒▒ █ █ ▒░
//░░  █   ░░░  █   ░░░  █   ░   ▒ ▓██░ ▒░▒██▀▀██░▒███      ░██   █▌▒██  ▀█▄  ▓██ ░▄█ ▒▓███▄░ ▓██░ ██▓▒▓██ ░▄█ ▒▒██░  ██▒▒██░▄▄▄░▓██ ░▄█ ▒▒██  ▀█▄  ▓██    ▓██░▒███   ▓██ ░▄█ ▒   ░░  █   ░░░  █   ░░░  █   ░
// ░ █ █ ▒  ░ █ █ ▒  ░ █ █ ▒    ░ ▓██▓ ░ ░▓█ ░██ ▒▓█  ▄    ░▓█▄   ▌░██▄▄▄▄██ ▒██▀▀█▄  ▓██ █▄ ▒██▄█▓▒ ▒▒██▀▀█▄  ▒██   ██░░▓█  ██▓▒██▀▀█▄  ░██▄▄▄▄██ ▒██    ▒██ ▒▓█  ▄ ▒██▀▀█▄      ░ █ █ ▒  ░ █ █ ▒  ░ █ █ ▒ 
//▒██▒ ▒██▒▒██▒ ▒██▒▒██▒ ▒██▒     ▒██▒ ░ ░▓█▒░██▓░▒████▒   ░▒████▓  ▓█   ▓██▒░██▓ ▒██▒▒██▒ █▄▒██▒ ░  ░░██▓ ▒██▒░ ████▓▒░░▒▓███▀▒░██▓ ▒██▒ ▓█   ▓██▒▒██▒   ░██▒░▒████▒░██▓ ▒██▒   ▒██▒ ▒██▒▒██▒ ▒██▒▒██▒ ▒██▒
//▒▒ ░ ░▓ ░▒▒ ░ ░▓ ░▒▒ ░ ░▓ ░     ▒ ░░    ▒ ░░▒░▒░░ ▒░ ░    ▒▒▓  ▒  ▒▒   ▓▒█░░ ▒▓ ░▒▓░▒ ▒▒ ▓▒▒▓▒░ ░  ░░ ▒▓ ░▒▓░░ ▒░▒░▒░  ░▒   ▒ ░ ▒▓ ░▒▓░ ▒▒   ▓▒█░░ ▒░   ░  ░░░ ▒░ ░░ ▒▓ ░▒▓░   ▒▒ ░ ░▓ ░▒▒ ░ ░▓ ░▒▒ ░ ░▓ ░
//░░   ░▒ ░░░   ░▒ ░░░   ░▒ ░       ░     ▒ ░▒░ ░ ░ ░  ░    ░ ▒  ▒   ▒   ▒▒ ░  ░▒ ░ ▒░░ ░▒ ▒░░▒ ░       ░▒ ░ ▒░  ░ ▒ ▒░   ░   ░   ░▒ ░ ▒░  ▒   ▒▒ ░░  ░      ░ ░ ░  ░  ░▒ ░ ▒░   ░░   ░▒ ░░░   ░▒ ░░░   ░▒ ░
// ░    ░   ░    ░   ░    ░       ░       ░  ░░ ░   ░       ░ ░  ░   ░   ▒     ░░   ░ ░ ░░ ░ ░░         ░░   ░ ░ ░ ░ ▒  ░ ░   ░   ░░   ░   ░   ▒   ░      ░      ░     ░░   ░     ░    ░   ░    ░   ░    ░  
// ░    ░   ░    ░   ░    ░               ░  ░  ░   ░  ░      ░          ░  ░   ░     ░  ░               ░         ░ ░        ░    ░           ░  ░       ░      ░  ░   ░         ░    ░   ░    ░   ░    ░  
//                                                          ░                                                        

//=======================================================================================
//          PeXploit's Simple Read SFO
//=======================================================================================





using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;
using System.Threading;

namespace PeXploit
{
    public partial class Read_SFO : Form
    {
        public Read_SFO()
        {
            InitializeComponent();
        }
        public string pkgpath {get;set;}
        public int i = 0;
        private Image getImageFromBytes(byte[] image)
        {
            MemoryStream ms = new MemoryStream(image, 0, image.Length);
            return Image.FromStream(ms, true);
        }
        private void Read_SFO_Load(object sender, EventArgs e)
        {
            try
            {
                if (Directory.Exists(pkgpath + @"\C00\"))
                {
                    PARAM_SFO para = new PARAM_SFO(pkgpath + @"\C00\PARAM.SFO");
                    backgroundWorker1.RunWorkerAsync();
                    textBox1.Text = para.TitleID;
                    textBox2.Text = para.Title;
                    textBox3.Text = para.DataType.ToString();
                    textBox4.Text = para.ContentID;
                        if (textBox4.Text !="")
                        {
                            lblEdat.Text = "Edat Enabled";
                        }
                    this.Text += " : " + para.Title.Replace("???", "-");
                }
                else
                {
                    PARAM_SFO para = new PARAM_SFO(pkgpath + @"\PARAM.SFO");
                    textBox1.Text = para.TitleID;
                    textBox2.Text = para.Title.Replace("???", "(TM)");
                    textBox3.Text = para.DataType.ToString();
                    textBox4.Text = para.ContentID;
                    this.Text += " : " + para.Title.Replace("???", "-");
                    if (textBox4.Text != "")
                    {
                        lblEdat.Text = "Edat Enabled";
                        backgroundWorker1.RunWorkerAsync();
                        return;

                    }
                    backgroundWorker1.RunWorkerAsync();
                    textBox4.Visible = false;
                    label4.Visible = false;
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message);
            }
        }

        private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)
        {
            while (i == 0)
            {
                if (Directory.Exists(pkgpath + @"\C00\") && i == 0)
                {
                    pictureBox1.ImageLocation = pkgpath + @"\C00\ICON0.PNG";
                    i = 1;
                    Thread.Sleep(1500);
                }
                else
                {
                    pictureBox1.ImageLocation = pkgpath + @"\ICON0.PNG";
                    i = 1;
                    Thread.Sleep(1500);
                }
            }
            while (i == 1)
            {
                try
                {
                    if (Directory.Exists(pkgpath + @"\C00\") && i == 1)
                    {
                        pictureBox1.ImageLocation = pkgpath + @"\C00\PIC1.PNG";
                        i = 0;
                        Thread.Sleep(1500);
                    }
                    else
                    {
                        pictureBox1.ImageLocation = pkgpath + @"\PIC1.PNG";
                        i = 0;
                        Thread.Sleep(1500);
                    }
                }
                catch (Exception ee)
                { }
            }
            
        }

        private void backgroundWorker1_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
                backgroundWorker1.RunWorkerAsync();
        }
    }
}
